                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 4.2.0 #13081 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module main
                                      6 	.optsdcc -mstm8
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _main
                                     12 	.globl _IRQ_Handler_TIM4
                                     13 	.globl _TimerMatch
                                     14 	.globl _ReadInputGpio
                                     15 	.globl _tick
                                     16 	.globl _SetTimer
                                     17 	.globl _TIM4_ClearITPendingBit
                                     18 	.globl _TIM4_ClearFlag
                                     19 	.globl _TIM4_ITConfig
                                     20 	.globl _TIM4_Cmd
                                     21 	.globl _TIM4_TimeBaseInit
                                     22 	.globl _TIM4_DeInit
                                     23 	.globl _CLK_PeripheralClockConfig
                                     24 	.globl _CLK_SYSCLKDivConfig
                                     25 	.globl _CLK_DeInit
                                     26 	.globl _GPIO_ReadInputDataBit
                                     27 	.globl _GPIO_ToggleBits
                                     28 	.globl _GPIO_ResetBits
                                     29 	.globl _GPIO_SetBits
                                     30 	.globl _GPIO_Init
                                     31 	.globl _GPIO_DeInit
                                     32 	.globl _SysCntrl
                                     33 	.globl _bMainTimer
                                     34 ;--------------------------------------------------------
                                     35 ; ram data
                                     36 ;--------------------------------------------------------
                                     37 	.area DATA
      000000                         38 _bMainTimer::
      000000                         39 	.ds 1
      000001                         40 _SysCntrl::
      000001                         41 	.ds 20
                                     42 ;--------------------------------------------------------
                                     43 ; ram data
                                     44 ;--------------------------------------------------------
                                     45 	.area INITIALIZED
                                     46 ;--------------------------------------------------------
                                     47 ; Stack segment in internal ram
                                     48 ;--------------------------------------------------------
                                     49 	.area	SSEG
      000000                         50 __start__stack:
      000000                         51 	.ds	1
                                     52 
                                     53 ;--------------------------------------------------------
                                     54 ; absolute external ram data
                                     55 ;--------------------------------------------------------
                                     56 	.area DABS (ABS)
                                     57 
                                     58 ; default segment ordering for linker
                                     59 	.area HOME
                                     60 	.area GSINIT
                                     61 	.area GSFINAL
                                     62 	.area CONST
                                     63 	.area INITIALIZER
                                     64 	.area CODE
                                     65 
                                     66 ;--------------------------------------------------------
                                     67 ; interrupt vector
                                     68 ;--------------------------------------------------------
                                     69 	.area HOME
      000000                         70 __interrupt_vect:
      000000 82v00u00u00             71 	int s_GSINIT ; reset
      000004 82 00 00 00             72 	int 0x000000 ; trap
      000008 82 00 00 00             73 	int 0x000000 ; int0
      00000C 82 00 00 00             74 	int 0x000000 ; int1
      000010 82 00 00 00             75 	int 0x000000 ; int2
      000014 82 00 00 00             76 	int 0x000000 ; int3
      000018 82 00 00 00             77 	int 0x000000 ; int4
      00001C 82 00 00 00             78 	int 0x000000 ; int5
      000020 82 00 00 00             79 	int 0x000000 ; int6
      000024 82 00 00 00             80 	int 0x000000 ; int7
      000028 82 00 00 00             81 	int 0x000000 ; int8
      00002C 82 00 00 00             82 	int 0x000000 ; int9
      000030 82 00 00 00             83 	int 0x000000 ; int10
      000034 82 00 00 00             84 	int 0x000000 ; int11
      000038 82 00 00 00             85 	int 0x000000 ; int12
      00003C 82 00 00 00             86 	int 0x000000 ; int13
      000040 82 00 00 00             87 	int 0x000000 ; int14
      000044 82 00 00 00             88 	int 0x000000 ; int15
      000048 82 00 00 00             89 	int 0x000000 ; int16
      00004C 82 00 00 00             90 	int 0x000000 ; int17
      000050 82 00 00 00             91 	int 0x000000 ; int18
      000054 82 00 00 00             92 	int 0x000000 ; int19
      000058 82 00 00 00             93 	int 0x000000 ; int20
      00005C 82 00 00 00             94 	int 0x000000 ; int21
      000060 82 00 00 00             95 	int 0x000000 ; int22
      000064 82 00 00 00             96 	int 0x000000 ; int23
      000068 82 00 00 00             97 	int 0x000000 ; int24
      00006C 82v00u02u62             98 	int _IRQ_Handler_TIM4 ; int25
                                     99 ;--------------------------------------------------------
                                    100 ; global & static initialisations
                                    101 ;--------------------------------------------------------
                                    102 	.area HOME
                                    103 	.area GSINIT
                                    104 	.area GSFINAL
                                    105 	.area GSINIT
      000000                        106 __sdcc_init_data:
                                    107 ; stm8_genXINIT() start
      000000 AEr00r00         [ 2]  108 	ldw x, #l_DATA
      000003 27 07            [ 1]  109 	jreq	00002$
      000005                        110 00001$:
      000005 72 4FuFFuFF      [ 1]  111 	clr (s_DATA - 1, x)
      000009 5A               [ 2]  112 	decw x
      00000A 26 F9            [ 1]  113 	jrne	00001$
      00000C                        114 00002$:
      00000C AEr00r00         [ 2]  115 	ldw	x, #l_INITIALIZER
      00000F 27 09            [ 1]  116 	jreq	00004$
      000011                        117 00003$:
      000011 D6uFFuFF         [ 1]  118 	ld	a, (s_INITIALIZER - 1, x)
      000014 D7uFFuFF         [ 1]  119 	ld	(s_INITIALIZED - 1, x), a
      000017 5A               [ 2]  120 	decw	x
      000018 26 F7            [ 1]  121 	jrne	00003$
      00001A                        122 00004$:
                                    123 ; stm8_genXINIT() end
                                    124 	.area GSFINAL
      000000 CCr00r70         [ 2]  125 	jp	__sdcc_program_startup
                                    126 ;--------------------------------------------------------
                                    127 ; Home
                                    128 ;--------------------------------------------------------
                                    129 	.area HOME
                                    130 	.area HOME
      000070                        131 __sdcc_program_startup:
      000070 CCr02r6E         [ 2]  132 	jp	_main
                                    133 ;	return from main will return to caller
                                    134 ;--------------------------------------------------------
                                    135 ; code
                                    136 ;--------------------------------------------------------
                                    137 	.area CODE
                                    138 ;	main.c: 38: void SetTimer(uint8_t tmr, unsigned int value)
                                    139 ;	-----------------------------------------
                                    140 ;	 function SetTimer
                                    141 ;	-----------------------------------------
      000000                        142 _SetTimer:
                                    143 ;	main.c: 40: switch (tmr) {
      000000 A1 00            [ 1]  144 	cp	a, #0x00
      000002 27 09            [ 1]  145 	jreq	00101$
      000004 A1 01            [ 1]  146 	cp	a, #0x01
      000006 27 09            [ 1]  147 	jreq	00102$
      000008 A1 02            [ 1]  148 	cp	a, #0x02
      00000A 27 09            [ 1]  149 	jreq	00103$
      00000C 81               [ 4]  150 	ret
                                    151 ;	main.c: 41: case 0:
      00000D                        152 00101$:
                                    153 ;	main.c: 42: SysCntrl.Timer_0 = value;
      00000D CFu00u01         [ 2]  154 	ldw	_SysCntrl+0, x
                                    155 ;	main.c: 43: break;
      000010 81               [ 4]  156 	ret
                                    157 ;	main.c: 44: case 1:
      000011                        158 00102$:
                                    159 ;	main.c: 45: SysCntrl.Timer_1 = value;
      000011 CFu00u03         [ 2]  160 	ldw	_SysCntrl+2, x
                                    161 ;	main.c: 46: break;
      000014 81               [ 4]  162 	ret
                                    163 ;	main.c: 47: case 2:
      000015                        164 00103$:
                                    165 ;	main.c: 48: SysCntrl.Timer_2 = value;
      000015 CFu00u05         [ 2]  166 	ldw	_SysCntrl+4, x
                                    167 ;	main.c: 50: }
                                    168 ;	main.c: 51: }
      000018 81               [ 4]  169 	ret
                                    170 ;	main.c: 53: void tick(enum event_t ev)
                                    171 ;	-----------------------------------------
                                    172 ;	 function tick
                                    173 ;	-----------------------------------------
      000019                        174 _tick:
      000019 52 02            [ 2]  175 	sub	sp, #2
      00001B 6B 02            [ 1]  176 	ld	(0x02, sp), a
                                    177 ;	main.c: 55: switch (SysCntrl.state) {
      00001D C6u00u09         [ 1]  178 	ld	a, _SysCntrl+8
      000020 97               [ 1]  179 	ld	xl, a
      000021 A1 07            [ 1]  180 	cp	a, #0x07
      000023 23 03            [ 2]  181 	jrule	00186$
      000025 CCr01r96         [ 2]  182 	jp	00129$
      000028                        183 00186$:
                                    184 ;	main.c: 77: if( ev == timer_2){
      000028 7B 02            [ 1]  185 	ld	a, (0x02, sp)
      00002A A0 03            [ 1]  186 	sub	a, #0x03
      00002C 26 04            [ 1]  187 	jrne	00188$
      00002E 4C               [ 1]  188 	inc	a
      00002F 6B 01            [ 1]  189 	ld	(0x01, sp), a
      000031 C5                     190 	.byte 0xc5
      000032                        191 00188$:
      000032 0F 01            [ 1]  192 	clr	(0x01, sp)
      000034                        193 00189$:
                                    194 ;	main.c: 110: if (ev == timer_0){
      000034 7B 02            [ 1]  195 	ld	a, (0x02, sp)
      000036 4A               [ 1]  196 	dec	a
      000037 26 03            [ 1]  197 	jrne	00191$
      000039 A6 01            [ 1]  198 	ld	a, #0x01
      00003B 21                     199 	.byte 0x21
      00003C                        200 00191$:
      00003C 4F               [ 1]  201 	clr	a
      00003D                        202 00192$:
                                    203 ;	main.c: 55: switch (SysCntrl.state) {
      00003D 02               [ 1]  204 	rlwa	x
      00003E 4F               [ 1]  205 	clr	a
      00003F 01               [ 1]  206 	rrwa	x
      000040 58               [ 2]  207 	sllw	x
      000041 DEu00u45         [ 2]  208 	ldw	x, (#00193$, x)
      000044 FC               [ 2]  209 	jp	(x)
      000045                        210 00193$:
      000045r00r55                  211 	.dw	#00101$
      000047r01r96                  212 	.dw	#00129$
      000049r00rAD                  213 	.dw	#00108$
      00004Br00rD3                  214 	.dw	#00111$
      00004Dr01r82                  215 	.dw	#00125$
      00004Fr00rF1                  216 	.dw	#00114$
      000051r01r17                  217 	.dw	#00117$
      000053r01r38                  218 	.dw	#00120$
                                    219 ;	main.c: 56: case WAIT_PWR_BTN:
      000055                        220 00101$:
                                    221 ;	main.c: 57: if (ev == start) {
      000055 0D 02            [ 1]  222 	tnz	(0x02, sp)
      000057 26 08            [ 1]  223 	jrne	00103$
                                    224 ;	main.c: 58: SetTimer(1, TIMER_1_SEC);
      000059 AE 00 64         [ 2]  225 	ldw	x, #0x0064
      00005C A6 01            [ 1]  226 	ld	a, #0x01
      00005E CDr00r00         [ 4]  227 	call	_SetTimer
      000061                        228 00103$:
                                    229 ;	main.c: 61: if ( ev == timer_1){
      000061 7B 02            [ 1]  230 	ld	a, (0x02, sp)
                                    231 ;	main.c: 62: GPIO_ToggleBits(LED_PWR);
      000063 A0 02            [ 1]  232 	sub	a, #0x02
      000065 26 0F            [ 1]  233 	jrne	00105$
      000067 4C               [ 1]  234 	inc	a
      000068 AE 50 0F         [ 2]  235 	ldw	x, #0x500f
      00006B CDr00r00         [ 4]  236 	call	_GPIO_ToggleBits
                                    237 ;	main.c: 63: SetTimer(1, TIMER_1_SEC);
      00006E AE 00 64         [ 2]  238 	ldw	x, #0x0064
      000071 A6 01            [ 1]  239 	ld	a, #0x01
      000073 CDr00r00         [ 4]  240 	call	_SetTimer
      000076                        241 00105$:
                                    242 ;	main.c: 65: if (ev == pwrbtn_on) {
      000076 7B 02            [ 1]  243 	ld	a, (0x02, sp)
      000078 A1 04            [ 1]  244 	cp	a, #0x04
      00007A 27 03            [ 1]  245 	jreq	00200$
      00007C CCr01r96         [ 2]  246 	jp	00129$
      00007F                        247 00200$:
                                    248 ;	main.c: 66: GPIO_SetBits(LED_PWR);
      00007F A6 01            [ 1]  249 	ld	a, #0x01
      000081 AE 50 0F         [ 2]  250 	ldw	x, #0x500f
      000084 CDr00r00         [ 4]  251 	call	_GPIO_SetBits
                                    252 ;	main.c: 67: GPIO_SetBits(ENABLE_5V);
      000087 A6 04            [ 1]  253 	ld	a, #0x04
      000089 AE 50 05         [ 2]  254 	ldw	x, #0x5005
      00008C CDr00r00         [ 4]  255 	call	_GPIO_SetBits
                                    256 ;	main.c: 68: GPIO_SetBits(RESET_CPU);
      00008F A6 80            [ 1]  257 	ld	a, #0x80
      000091 AE 50 05         [ 2]  258 	ldw	x, #0x5005
      000094 CDr00r00         [ 4]  259 	call	_GPIO_SetBits
                                    260 ;	main.c: 69: SetTimer(0, TIMER_500_MS);
      000097 AE 00 32         [ 2]  261 	ldw	x, #0x0032
      00009A 4F               [ 1]  262 	clr	a
      00009B CDr00r00         [ 4]  263 	call	_SetTimer
                                    264 ;	main.c: 71: SetTimer(2, TIMER_50_MS);
      00009E AE 00 05         [ 2]  265 	ldw	x, #0x0005
      0000A1 A6 02            [ 1]  266 	ld	a, #0x02
      0000A3 CDr00r00         [ 4]  267 	call	_SetTimer
                                    268 ;	main.c: 72: SysCntrl.state = WAIT_PGOOD;
      0000A6 35 02u00u09      [ 1]  269 	mov	_SysCntrl+8, #0x02
                                    270 ;	main.c: 74: break;
      0000AA CCr01r96         [ 2]  271 	jp	00129$
                                    272 ;	main.c: 75: case WAIT_PGOOD:
      0000AD                        273 00108$:
                                    274 ;	main.c: 77: if( ev == timer_2){
      0000AD 0D 01            [ 1]  275 	tnz	(0x01, sp)
      0000AF 26 03            [ 1]  276 	jrne	00201$
      0000B1 CCr01r96         [ 2]  277 	jp	00129$
      0000B4                        278 00201$:
                                    279 ;	main.c: 78: GPIO_ResetBits(LED_GOOD);
      0000B4 A6 08            [ 1]  280 	ld	a, #0x08
      0000B6 AE 50 00         [ 2]  281 	ldw	x, #0x5000
      0000B9 CDr00r00         [ 4]  282 	call	_GPIO_ResetBits
                                    283 ;	main.c: 79: GPIO_SetBits(PG_SMARC);
      0000BC A6 08            [ 1]  284 	ld	a, #0x08
      0000BE AE 50 05         [ 2]  285 	ldw	x, #0x5005
      0000C1 CDr00r00         [ 4]  286 	call	_GPIO_SetBits
                                    287 ;	main.c: 80: SetTimer(2, TIMER_50_MS);
      0000C4 AE 00 05         [ 2]  288 	ldw	x, #0x0005
      0000C7 A6 02            [ 1]  289 	ld	a, #0x02
      0000C9 CDr00r00         [ 4]  290 	call	_SetTimer
                                    291 ;	main.c: 81: SysCntrl.state = WAIT_CARRIER_ON;
      0000CC 35 03u00u09      [ 1]  292 	mov	_SysCntrl+8, #0x03
                                    293 ;	main.c: 84: break;
      0000D0 CCr01r96         [ 2]  294 	jp	00129$
                                    295 ;	main.c: 85: case WAIT_CARRIER_ON:
      0000D3                        296 00111$:
                                    297 ;	main.c: 87: if( ev == timer_2){
      0000D3 0D 01            [ 1]  298 	tnz	(0x01, sp)
      0000D5 26 03            [ 1]  299 	jrne	00202$
      0000D7 CCr01r96         [ 2]  300 	jp	00129$
      0000DA                        301 00202$:
                                    302 ;	main.c: 88: GPIO_SetBits(ENABLE_DCDC);
      0000DA A6 02            [ 1]  303 	ld	a, #0x02
      0000DC AE 50 05         [ 2]  304 	ldw	x, #0x5005
      0000DF CDr00r00         [ 4]  305 	call	_GPIO_SetBits
                                    306 ;	main.c: 89: SetTimer(2, TIMER_50_MS);
      0000E2 AE 00 05         [ 2]  307 	ldw	x, #0x0005
      0000E5 A6 02            [ 1]  308 	ld	a, #0x02
      0000E7 CDr00r00         [ 4]  309 	call	_SetTimer
                                    310 ;	main.c: 90: SysCntrl.state = CPU_START;
      0000EA 35 05u00u09      [ 1]  311 	mov	_SysCntrl+8, #0x05
                                    312 ;	main.c: 92: break;
      0000EE CCr01r96         [ 2]  313 	jp	00129$
                                    314 ;	main.c: 93: case CPU_START:
      0000F1                        315 00114$:
                                    316 ;	main.c: 94: if (ev == timer_2){
      0000F1 0D 01            [ 1]  317 	tnz	(0x01, sp)
      0000F3 26 03            [ 1]  318 	jrne	00203$
      0000F5 CCr01r96         [ 2]  319 	jp	00129$
      0000F8                        320 00203$:
                                    321 ;	main.c: 95: GPIO_SetBits(POWER_CPU);
      0000F8 A6 40            [ 1]  322 	ld	a, #0x40
      0000FA AE 50 05         [ 2]  323 	ldw	x, #0x5005
      0000FD CDr00r00         [ 4]  324 	call	_GPIO_SetBits
                                    325 ;	main.c: 96: GPIO_SetBits(LED_PWR);
      000100 A6 01            [ 1]  326 	ld	a, #0x01
      000102 AE 50 0F         [ 2]  327 	ldw	x, #0x500f
      000105 CDr00r00         [ 4]  328 	call	_GPIO_SetBits
                                    329 ;	main.c: 97: SetTimer(2, TIMER_50_MS);
      000108 AE 00 05         [ 2]  330 	ldw	x, #0x0005
      00010B A6 02            [ 1]  331 	ld	a, #0x02
      00010D CDr00r00         [ 4]  332 	call	_SetTimer
                                    333 ;	main.c: 98: SysCntrl.state = CPU_NO_RST;
      000110 35 06u00u09      [ 1]  334 	mov	_SysCntrl+8, #0x06
                                    335 ;	main.c: 100: break;
      000114 CCr01r96         [ 2]  336 	jp	00129$
                                    337 ;	main.c: 101: case CPU_NO_RST:
      000117                        338 00117$:
                                    339 ;	main.c: 102: if (ev == timer_2){
      000117 0D 01            [ 1]  340 	tnz	(0x01, sp)
      000119 27 7B            [ 1]  341 	jreq	00129$
                                    342 ;	main.c: 103: GPIO_ResetBits(RESET_CPU);
      00011B A6 80            [ 1]  343 	ld	a, #0x80
      00011D AE 50 05         [ 2]  344 	ldw	x, #0x5005
      000120 CDr00r00         [ 4]  345 	call	_GPIO_ResetBits
                                    346 ;	main.c: 104: GPIO_SetBits(LED_PWR);
      000123 A6 01            [ 1]  347 	ld	a, #0x01
      000125 AE 50 0F         [ 2]  348 	ldw	x, #0x500f
      000128 CDr00r00         [ 4]  349 	call	_GPIO_SetBits
                                    350 ;	main.c: 105: SetTimer(0, TIMER_1_SEC);
      00012B AE 00 64         [ 2]  351 	ldw	x, #0x0064
      00012E 4F               [ 1]  352 	clr	a
      00012F CDr00r00         [ 4]  353 	call	_SetTimer
                                    354 ;	main.c: 106: SysCntrl.state = WORK_STATE;
      000132 35 07u00u09      [ 1]  355 	mov	_SysCntrl+8, #0x07
                                    356 ;	main.c: 108: break;
      000136 20 5E            [ 2]  357 	jra	00129$
                                    358 ;	main.c: 109: case WORK_STATE:
      000138                        359 00120$:
                                    360 ;	main.c: 110: if (ev == timer_0){
      000138 4D               [ 1]  361 	tnz	a
      000139 27 0F            [ 1]  362 	jreq	00122$
                                    363 ;	main.c: 111: GPIO_ToggleBits(LED_GOOD);
      00013B A6 08            [ 1]  364 	ld	a, #0x08
      00013D AE 50 00         [ 2]  365 	ldw	x, #0x5000
      000140 CDr00r00         [ 4]  366 	call	_GPIO_ToggleBits
                                    367 ;	main.c: 112: SetTimer(0, TIMER_1_SEC);
      000143 AE 00 64         [ 2]  368 	ldw	x, #0x0064
      000146 4F               [ 1]  369 	clr	a
      000147 CDr00r00         [ 4]  370 	call	_SetTimer
      00014A                        371 00122$:
                                    372 ;	main.c: 115: if (ev == pwrbtn_off){
      00014A 7B 02            [ 1]  373 	ld	a, (0x02, sp)
      00014C A1 05            [ 1]  374 	cp	a, #0x05
      00014E 26 46            [ 1]  375 	jrne	00129$
                                    376 ;	main.c: 116: GPIO_ResetBits(POWER_CPU);
      000150 A6 40            [ 1]  377 	ld	a, #0x40
      000152 AE 50 05         [ 2]  378 	ldw	x, #0x5005
      000155 CDr00r00         [ 4]  379 	call	_GPIO_ResetBits
                                    380 ;	main.c: 117: GPIO_ResetBits(ENABLE_DCDC);
      000158 A6 02            [ 1]  381 	ld	a, #0x02
      00015A AE 50 05         [ 2]  382 	ldw	x, #0x5005
      00015D CDr00r00         [ 4]  383 	call	_GPIO_ResetBits
                                    384 ;	main.c: 118: GPIO_ResetBits(ENABLE_5V);
      000160 A6 04            [ 1]  385 	ld	a, #0x04
      000162 AE 50 05         [ 2]  386 	ldw	x, #0x5005
      000165 CDr00r00         [ 4]  387 	call	_GPIO_ResetBits
                                    388 ;	main.c: 119: GPIO_ResetBits(PG_SMARC);
      000168 A6 08            [ 1]  389 	ld	a, #0x08
      00016A AE 50 05         [ 2]  390 	ldw	x, #0x5005
      00016D CDr00r00         [ 4]  391 	call	_GPIO_ResetBits
                                    392 ;	main.c: 120: GPIO_SetBits(LED_GOOD);
      000170 A6 08            [ 1]  393 	ld	a, #0x08
      000172 AE 50 00         [ 2]  394 	ldw	x, #0x5000
      000175 CDr00r00         [ 4]  395 	call	_GPIO_SetBits
                                    396 ;	main.c: 121: SysCntrl.state = WAIT_PWR_BTN;
      000178 35 00u00u09      [ 1]  397 	mov	_SysCntrl+8, #0x00
                                    398 ;	main.c: 122: tick(start);
      00017C 4F               [ 1]  399 	clr	a
      00017D 5B 02            [ 2]  400 	addw	sp, #2
                                    401 ;	main.c: 124: break;
      00017F CCr00r19         [ 2]  402 	jp	_tick
                                    403 ;	main.c: 125: case PWR_ERROR:
      000182                        404 00125$:
                                    405 ;	main.c: 126: if ( ev == timer_0){
      000182 4D               [ 1]  406 	tnz	a
      000183 27 11            [ 1]  407 	jreq	00129$
                                    408 ;	main.c: 127: GPIO_ToggleBits(LED_PWR);
      000185 A6 01            [ 1]  409 	ld	a, #0x01
      000187 AE 50 0F         [ 2]  410 	ldw	x, #0x500f
      00018A CDr00r00         [ 4]  411 	call	_GPIO_ToggleBits
                                    412 ;	main.c: 128: SetTimer(0, TIMER_100_MS);
      00018D AE 00 0A         [ 2]  413 	ldw	x, #0x000a
      000190 4F               [ 1]  414 	clr	a
      000191 5B 02            [ 2]  415 	addw	sp, #2
      000193 CCr00r00         [ 2]  416 	jp	_SetTimer
                                    417 ;	main.c: 131: }
      000196                        418 00129$:
                                    419 ;	main.c: 132: }
      000196 5B 02            [ 2]  420 	addw	sp, #2
      000198 81               [ 4]  421 	ret
                                    422 ;	main.c: 134: void ReadInputGpio() {
                                    423 ;	-----------------------------------------
                                    424 ;	 function ReadInputGpio
                                    425 ;	-----------------------------------------
      000199                        426 _ReadInputGpio:
      000199 52 02            [ 2]  427 	sub	sp, #2
                                    428 ;	main.c: 136: SysCntrl.btn_state = GPIO_ReadInputDataBit(PWR_BTN);
      00019B A6 04            [ 1]  429 	ld	a, #0x04
      00019D AE 50 00         [ 2]  430 	ldw	x, #0x5000
      0001A0 CDr00r00         [ 4]  431 	call	_GPIO_ReadInputDataBit
      0001A3 6B 02            [ 1]  432 	ld	(0x02, sp), a
      0001A5 AEr00r0B         [ 2]  433 	ldw	x, #(_SysCntrl+10)
      0001A8 7B 02            [ 1]  434 	ld	a, (0x02, sp)
      0001AA F7               [ 1]  435 	ld	(x), a
                                    436 ;	main.c: 137: SysCntrl.btn_change_time = SysCntrl.Timer;
      0001AB CEu00u07         [ 2]  437 	ldw	x, _SysCntrl+6
      0001AE CFu00u0E         [ 2]  438 	ldw	_SysCntrl+13, x
                                    439 ;	main.c: 139: if (SysCntrl.btn_state != SysCntrl.btn_state_prev){
      0001B1 C6u00u0B         [ 1]  440 	ld	a, _SysCntrl+10
      0001B4 90 97            [ 1]  441 	ld	yl, a
      0001B6 AEr00r0A         [ 2]  442 	ldw	x, #(_SysCntrl+0)+9
      0001B9 F6               [ 1]  443 	ld	a, (x)
                                    444 ;	main.c: 141: SysCntrl.btn_last_change = SysCntrl.btn_change_time;
                                    445 ;	main.c: 139: if (SysCntrl.btn_state != SysCntrl.btn_state_prev){
      0001BA 11 02            [ 1]  446 	cp	a, (0x02, sp)
      0001BC 27 09            [ 1]  447 	jreq	00102$
                                    448 ;	main.c: 140: SysCntrl.btn_state_prev = SysCntrl.btn_state;
      0001BE 90 9F            [ 1]  449 	ld	a, yl
      0001C0 F7               [ 1]  450 	ld	(x), a
                                    451 ;	main.c: 141: SysCntrl.btn_last_change = SysCntrl.btn_change_time;
      0001C1 CEu00u0E         [ 2]  452 	ldw	x, _SysCntrl+13
      0001C4 CFu00u0C         [ 2]  453 	ldw	_SysCntrl+11, x
      0001C7                        454 00102$:
      0001C7 90 CEu00u0E      [ 2]  455 	ldw	y, _SysCntrl+13
                                    456 ;	main.c: 144: if (SysCntrl.btn_change_time - SysCntrl.btn_last_change >= TIMER_2_SEC){
      0001CB CEu00u0C         [ 2]  457 	ldw	x, _SysCntrl+11
      0001CE 1F 01            [ 2]  458 	ldw	(0x01, sp), x
      0001D0 93               [ 1]  459 	ldw	x, y
      0001D1 72 F0 01         [ 2]  460 	subw	x, (0x01, sp)
      0001D4 A3 00 C8         [ 2]  461 	cpw	x, #0x00c8
      0001D7 25 0C            [ 1]  462 	jrc	00110$
                                    463 ;	main.c: 145: if (SysCntrl.btn_state == RESET){
      0001D9 C6u00u0B         [ 1]  464 	ld	a, _SysCntrl+10
      0001DC 26 16            [ 1]  465 	jrne	00111$
                                    466 ;	main.c: 146: tick(pwrbtn_off);
      0001DE A6 05            [ 1]  467 	ld	a, #0x05
      0001E0 CDr00r19         [ 4]  468 	call	_tick
      0001E3 20 0F            [ 2]  469 	jra	00111$
      0001E5                        470 00110$:
                                    471 ;	main.c: 150: if (SysCntrl.btn_change_time - SysCntrl.btn_last_change >= TIMER_50_MS)
      0001E5 A3 00 05         [ 2]  472 	cpw	x, #0x0005
      0001E8 25 0A            [ 1]  473 	jrc	00111$
                                    474 ;	main.c: 152: if (SysCntrl.btn_state == RESET){
      0001EA C6u00u0B         [ 1]  475 	ld	a, _SysCntrl+10
      0001ED 26 05            [ 1]  476 	jrne	00111$
                                    477 ;	main.c: 153: tick(pwrbtn_on);
      0001EF A6 04            [ 1]  478 	ld	a, #0x04
      0001F1 CDr00r19         [ 4]  479 	call	_tick
      0001F4                        480 00111$:
                                    481 ;	main.c: 159: if( GPIO_ReadInputDataBit(PG_5V) ){
      0001F4 A6 10            [ 1]  482 	ld	a, #0x10
      0001F6 AE 50 05         [ 2]  483 	ldw	x, #0x5005
      0001F9 CDr00r00         [ 4]  484 	call	_GPIO_ReadInputDataBit
      0001FC 4D               [ 1]  485 	tnz	a
      0001FD 27 05            [ 1]  486 	jreq	00113$
                                    487 ;	main.c: 160: tick(pgood_5v);
      0001FF A6 06            [ 1]  488 	ld	a, #0x06
      000201 CDr00r19         [ 4]  489 	call	_tick
      000204                        490 00113$:
                                    491 ;	main.c: 163: if( GPIO_ReadInputDataBit(CARRIER_PWR_ON) ){
      000204 A6 20            [ 1]  492 	ld	a, #0x20
      000206 AE 50 05         [ 2]  493 	ldw	x, #0x5005
      000209 CDr00r00         [ 4]  494 	call	_GPIO_ReadInputDataBit
      00020C 4D               [ 1]  495 	tnz	a
      00020D 27 07            [ 1]  496 	jreq	00116$
                                    497 ;	main.c: 164: tick(carrier);
      00020F A6 07            [ 1]  498 	ld	a, #0x07
      000211 5B 02            [ 2]  499 	addw	sp, #2
      000213 CCr00r19         [ 2]  500 	jp	_tick
      000216                        501 00116$:
                                    502 ;	main.c: 167: }
      000216 5B 02            [ 2]  503 	addw	sp, #2
      000218 81               [ 4]  504 	ret
                                    505 ;	main.c: 170: void TimerMatch()
                                    506 ;	-----------------------------------------
                                    507 ;	 function TimerMatch
                                    508 ;	-----------------------------------------
      000219                        509 _TimerMatch:
                                    510 ;	main.c: 172: if (!bMainTimer) {
      000219 C6u00u00         [ 1]  511 	ld	a, _bMainTimer+0
      00021C 26 01            [ 1]  512 	jrne	00102$
                                    513 ;	main.c: 173: return;
      00021E 81               [ 4]  514 	ret
      00021F                        515 00102$:
                                    516 ;	main.c: 175: bMainTimer = 0;
      00021F 72 5Fu00u00      [ 1]  517 	clr	_bMainTimer+0
                                    518 ;	main.c: 176: SysCntrl.Timer++;
      000223 CEu00u07         [ 2]  519 	ldw	x, _SysCntrl+6
      000226 5C               [ 1]  520 	incw	x
      000227 CFu00u07         [ 2]  521 	ldw	_SysCntrl+6, x
                                    522 ;	main.c: 179: if (SysCntrl.Timer_0) { 
      00022A CEu00u01         [ 2]  523 	ldw	x, _SysCntrl+0
      00022D 5D               [ 2]  524 	tnzw	x
      00022E 27 0C            [ 1]  525 	jreq	00106$
                                    526 ;	main.c: 180: SysCntrl.Timer_0--;
      000230 5A               [ 2]  527 	decw	x
      000231 CFu00u01         [ 2]  528 	ldw	_SysCntrl+0, x
                                    529 ;	main.c: 181: if (!SysCntrl.Timer_0) {
      000234 5D               [ 2]  530 	tnzw	x
      000235 26 05            [ 1]  531 	jrne	00106$
                                    532 ;	main.c: 182: tick(timer_0);
      000237 A6 01            [ 1]  533 	ld	a, #0x01
      000239 CDr00r19         [ 4]  534 	call	_tick
      00023C                        535 00106$:
                                    536 ;	main.c: 187: if (SysCntrl.Timer_1) { 
      00023C CEu00u03         [ 2]  537 	ldw	x, _SysCntrl+2
      00023F 5D               [ 2]  538 	tnzw	x
      000240 27 0C            [ 1]  539 	jreq	00110$
                                    540 ;	main.c: 188: SysCntrl.Timer_1--;
      000242 5A               [ 2]  541 	decw	x
      000243 CFu00u03         [ 2]  542 	ldw	_SysCntrl+2, x
                                    543 ;	main.c: 189: if (!SysCntrl.Timer_1) {
      000246 5D               [ 2]  544 	tnzw	x
      000247 26 05            [ 1]  545 	jrne	00110$
                                    546 ;	main.c: 190: tick(timer_1);
      000249 A6 02            [ 1]  547 	ld	a, #0x02
      00024B CDr00r19         [ 4]  548 	call	_tick
      00024E                        549 00110$:
                                    550 ;	main.c: 195: if (SysCntrl.Timer_2) {
      00024E CEu00u05         [ 2]  551 	ldw	x, _SysCntrl+4
      000251 5D               [ 2]  552 	tnzw	x
      000252 26 01            [ 1]  553 	jrne	00157$
      000254 81               [ 4]  554 	ret
      000255                        555 00157$:
                                    556 ;	main.c: 196: SysCntrl.Timer_2--;
      000255 5A               [ 2]  557 	decw	x
      000256 CFu00u05         [ 2]  558 	ldw	_SysCntrl+4, x
                                    559 ;	main.c: 197: if (!SysCntrl.Timer_2) {
      000259 5D               [ 2]  560 	tnzw	x
      00025A 27 01            [ 1]  561 	jreq	00158$
      00025C 81               [ 4]  562 	ret
      00025D                        563 00158$:
                                    564 ;	main.c: 198: tick(timer_2);
      00025D A6 03            [ 1]  565 	ld	a, #0x03
                                    566 ;	main.c: 201: }
      00025F CCr00r19         [ 2]  567 	jp	_tick
                                    568 ;	main.c: 205: INTERRUPT_HANDLER(IRQ_Handler_TIM4, 25)
                                    569 ;	-----------------------------------------
                                    570 ;	 function IRQ_Handler_TIM4
                                    571 ;	-----------------------------------------
      000262                        572 _IRQ_Handler_TIM4:
      000262 4F               [ 1]  573 	clr	a
      000263 62               [ 2]  574 	div	x, a
                                    575 ;	main.c: 207: bMainTimer = 1;
      000264 35 01u00u00      [ 1]  576 	mov	_bMainTimer+0, #0x01
                                    577 ;	main.c: 208: TIM4_ClearITPendingBit(TIM4_IT_Update);
      000268 A6 01            [ 1]  578 	ld	a, #0x01
      00026A CDr00r00         [ 4]  579 	call	_TIM4_ClearITPendingBit
                                    580 ;	main.c: 209: }
      00026D 80               [11]  581 	iret
                                    582 ;	main.c: 211: int main( void )
                                    583 ;	-----------------------------------------
                                    584 ;	 function main
                                    585 ;	-----------------------------------------
      00026E                        586 _main:
                                    587 ;	main.c: 213: disableInterrupts();
      00026E 9B               [ 1]  588 	sim;	
                                    589 ;	main.c: 215: GPIO_DeInit(GPIOA);
      00026F AE 50 00         [ 2]  590 	ldw	x, #0x5000
      000272 CDr00r00         [ 4]  591 	call	_GPIO_DeInit
                                    592 ;	main.c: 216: GPIO_DeInit(GPIOB);
      000275 AE 50 05         [ 2]  593 	ldw	x, #0x5005
      000278 CDr00r00         [ 4]  594 	call	_GPIO_DeInit
                                    595 ;	main.c: 217: GPIO_DeInit(GPIOC);
      00027B AE 50 0A         [ 2]  596 	ldw	x, #0x500a
      00027E CDr00r00         [ 4]  597 	call	_GPIO_DeInit
                                    598 ;	main.c: 218: GPIO_DeInit(GPIOD);
      000281 AE 50 0F         [ 2]  599 	ldw	x, #0x500f
      000284 CDr00r00         [ 4]  600 	call	_GPIO_DeInit
                                    601 ;	main.c: 220: GPIO_Init(LED_GOOD, GPIO_Mode_Out_PP_High_Fast);
      000287 4B F0            [ 1]  602 	push	#0xf0
      000289 A6 08            [ 1]  603 	ld	a, #0x08
      00028B AE 50 00         [ 2]  604 	ldw	x, #0x5000
      00028E CDr00r00         [ 4]  605 	call	_GPIO_Init
                                    606 ;	main.c: 221: GPIO_Init(LED_PWR, GPIO_Mode_Out_PP_Low_Fast);
      000291 4B E0            [ 1]  607 	push	#0xe0
      000293 A6 01            [ 1]  608 	ld	a, #0x01
      000295 AE 50 0F         [ 2]  609 	ldw	x, #0x500f
      000298 CDr00r00         [ 4]  610 	call	_GPIO_Init
                                    611 ;	main.c: 222: GPIO_Init(ENABLE_DCDC, GPIO_Mode_Out_PP_Low_Fast);
      00029B 4B E0            [ 1]  612 	push	#0xe0
      00029D A6 02            [ 1]  613 	ld	a, #0x02
      00029F AE 50 05         [ 2]  614 	ldw	x, #0x5005
      0002A2 CDr00r00         [ 4]  615 	call	_GPIO_Init
                                    616 ;	main.c: 223: GPIO_Init(ENABLE_5V, GPIO_Mode_Out_PP_Low_Fast);
      0002A5 4B E0            [ 1]  617 	push	#0xe0
      0002A7 A6 04            [ 1]  618 	ld	a, #0x04
      0002A9 AE 50 05         [ 2]  619 	ldw	x, #0x5005
      0002AC CDr00r00         [ 4]  620 	call	_GPIO_Init
                                    621 ;	main.c: 224: GPIO_Init(PG_SMARC, GPIO_Mode_Out_PP_Low_Fast);
      0002AF 4B E0            [ 1]  622 	push	#0xe0
      0002B1 A6 08            [ 1]  623 	ld	a, #0x08
      0002B3 AE 50 05         [ 2]  624 	ldw	x, #0x5005
      0002B6 CDr00r00         [ 4]  625 	call	_GPIO_Init
                                    626 ;	main.c: 225: GPIO_Init(POWER_CPU, GPIO_Mode_Out_PP_Low_Fast);
      0002B9 4B E0            [ 1]  627 	push	#0xe0
      0002BB A6 40            [ 1]  628 	ld	a, #0x40
      0002BD AE 50 05         [ 2]  629 	ldw	x, #0x5005
      0002C0 CDr00r00         [ 4]  630 	call	_GPIO_Init
                                    631 ;	main.c: 226: GPIO_Init(RESET_CPU, GPIO_Mode_Out_PP_Low_Fast);
      0002C3 4B E0            [ 1]  632 	push	#0xe0
      0002C5 A6 80            [ 1]  633 	ld	a, #0x80
      0002C7 AE 50 05         [ 2]  634 	ldw	x, #0x5005
      0002CA CDr00r00         [ 4]  635 	call	_GPIO_Init
                                    636 ;	main.c: 227: GPIO_Init(WDOG_OUT, GPIO_Mode_Out_PP_Low_Fast);
      0002CD 4B E0            [ 1]  637 	push	#0xe0
      0002CF A6 10            [ 1]  638 	ld	a, #0x10
      0002D1 AE 50 0A         [ 2]  639 	ldw	x, #0x500a
      0002D4 CDr00r00         [ 4]  640 	call	_GPIO_Init
                                    641 ;	main.c: 229: GPIO_Init(PWR_BTN, GPIO_Mode_In_PU_No_IT);
      0002D7 4B 40            [ 1]  642 	push	#0x40
      0002D9 A6 04            [ 1]  643 	ld	a, #0x04
      0002DB AE 50 00         [ 2]  644 	ldw	x, #0x5000
      0002DE CDr00r00         [ 4]  645 	call	_GPIO_Init
                                    646 ;	main.c: 230: GPIO_Init(PG_5V, GPIO_Mode_In_PU_No_IT);
      0002E1 4B 40            [ 1]  647 	push	#0x40
      0002E3 A6 10            [ 1]  648 	ld	a, #0x10
      0002E5 AE 50 05         [ 2]  649 	ldw	x, #0x5005
      0002E8 CDr00r00         [ 4]  650 	call	_GPIO_Init
                                    651 ;	main.c: 231: GPIO_Init(CARRIER_PWR_ON, GPIO_Mode_In_PU_No_IT);
      0002EB 4B 40            [ 1]  652 	push	#0x40
      0002ED A6 20            [ 1]  653 	ld	a, #0x20
      0002EF AE 50 05         [ 2]  654 	ldw	x, #0x5005
      0002F2 CDr00r00         [ 4]  655 	call	_GPIO_Init
                                    656 ;	main.c: 232: GPIO_Init(WDOG_IN, GPIO_Mode_In_PU_No_IT);
      0002F5 4B 40            [ 1]  657 	push	#0x40
      0002F7 A6 01            [ 1]  658 	ld	a, #0x01
      0002F9 AE 50 05         [ 2]  659 	ldw	x, #0x5005
      0002FC CDr00r00         [ 4]  660 	call	_GPIO_Init
                                    661 ;	main.c: 236: CLK_DeInit();
      0002FF CDr00r00         [ 4]  662 	call	_CLK_DeInit
                                    663 ;	main.c: 237: CLK_SYSCLKDivConfig(CLK_SYSCLKDiv_1);
      000302 4F               [ 1]  664 	clr	a
      000303 CDr00r00         [ 4]  665 	call	_CLK_SYSCLKDivConfig
                                    666 ;	main.c: 238: CLK_PeripheralClockConfig(CLK_Peripheral_TIM4, ENABLE);
      000306 4B 01            [ 1]  667 	push	#0x01
      000308 A6 02            [ 1]  668 	ld	a, #0x02
      00030A CDr00r00         [ 4]  669 	call	_CLK_PeripheralClockConfig
                                    670 ;	main.c: 239: CLK_PeripheralClockConfig(CLK_Peripheral_USART1, ENABLE);
      00030D 4B 01            [ 1]  671 	push	#0x01
      00030F A6 05            [ 1]  672 	ld	a, #0x05
      000311 CDr00r00         [ 4]  673 	call	_CLK_PeripheralClockConfig
                                    674 ;	main.c: 241: TIM4_DeInit();
      000314 CDr00r00         [ 4]  675 	call	_TIM4_DeInit
                                    676 ;	main.c: 243: TIM4_Cmd(DISABLE); 
      000317 4F               [ 1]  677 	clr	a
      000318 CDr00r00         [ 4]  678 	call	_TIM4_Cmd
                                    679 ;	main.c: 244: TIM4_TimeBaseInit(TIM4_Prescaler_1024, 156);
      00031B 4B 9C            [ 1]  680 	push	#0x9c
      00031D A6 0A            [ 1]  681 	ld	a, #0x0a
      00031F CDr00r00         [ 4]  682 	call	_TIM4_TimeBaseInit
                                    683 ;	main.c: 245: TIM4_ClearFlag(TIM4_FLAG_Update);
      000322 A6 01            [ 1]  684 	ld	a, #0x01
      000324 CDr00r00         [ 4]  685 	call	_TIM4_ClearFlag
                                    686 ;	main.c: 246: TIM4_ITConfig(TIM4_IT_Update, ENABLE);
      000327 4B 01            [ 1]  687 	push	#0x01
      000329 A6 01            [ 1]  688 	ld	a, #0x01
      00032B CDr00r00         [ 4]  689 	call	_TIM4_ITConfig
                                    690 ;	main.c: 247: TIM4_Cmd(ENABLE);       // let's go
      00032E A6 01            [ 1]  691 	ld	a, #0x01
      000330 CDr00r00         [ 4]  692 	call	_TIM4_Cmd
                                    693 ;	main.c: 248: enableInterrupts();
      000333 9A               [ 1]  694 	rim;	
                                    695 ;	main.c: 251: bMainTimer = 0;
      000334 72 5Fu00u00      [ 1]  696 	clr	_bMainTimer+0
                                    697 ;	main.c: 252: SysCntrl.btn_state = SET;
      000338 35 01u00u0B      [ 1]  698 	mov	_SysCntrl+10, #0x01
                                    699 ;	main.c: 253: SysCntrl.btn_state_prev = SET;
      00033C 35 01u00u0A      [ 1]  700 	mov	_SysCntrl+9, #0x01
                                    701 ;	main.c: 254: SysCntrl.btn_change_time = 0;
      000340 AEr00r0E         [ 2]  702 	ldw	x, #(_SysCntrl+13)
      000343 6F 01            [ 1]  703 	clr	(0x1, x)
      000345 7F               [ 1]  704 	clr	(x)
                                    705 ;	main.c: 255: SysCntrl.btn_last_change = 0;
      000346 AEr00r0C         [ 2]  706 	ldw	x, #(_SysCntrl+11)
      000349 6F 01            [ 1]  707 	clr	(0x1, x)
      00034B 7F               [ 1]  708 	clr	(x)
                                    709 ;	main.c: 257: tick(start);
      00034C 4F               [ 1]  710 	clr	a
      00034D CDr00r19         [ 4]  711 	call	_tick
                                    712 ;	main.c: 258: while (1) {
      000350                        713 00102$:
                                    714 ;	main.c: 259: ReadInputGpio();
      000350 CDr01r99         [ 4]  715 	call	_ReadInputGpio
                                    716 ;	main.c: 260: TimerMatch();
      000353 CDr02r19         [ 4]  717 	call	_TimerMatch
      000356 20 F8            [ 2]  718 	jra	00102$
                                    719 ;	main.c: 264: }
      000358 81               [ 4]  720 	ret
                                    721 	.area CODE
                                    722 	.area CONST
                                    723 	.area INITIALIZER
                                    724 	.area CABS (ABS)
